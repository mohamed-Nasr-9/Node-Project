import{a as U,b as K,c as Q}from"./chunk-RZHO2OWO.js";import{b as J}from"./chunk-OHDIIJHJ.js";import{a as F}from"./chunk-VRDYXINS.js";import{$a as w,Aa as p,Ab as O,C,Ec as j,H as f,I as h,Ic as k,Jc as W,Kc as R,Lc as L,Mc as q,Oa as r,Ob as V,Qa as d,Ta as v,Ua as _,Uc as G,V as a,Va as A,Vc as Y,Wc as z,Ya as E,Yc as H,aa as x,ab as B,cb as D,da as S,ea as y,ia as g,na as l,oa as o,pa as i,qa as m,qb as N,sb as P,xa as I,xb as T,za as M}from"./chunk-DBZ4JVQV.js";var $=()=>[],ee=(t,n,e)=>({"bg-warning":t,"bg-success":n,"bg-danger":e});function te(t,n){if(t&1&&(o(0,"div",17)(1,"strong"),r(2,"Applied:"),i(),r(3),B(4,"date"),i()),t&2){let e=p(2);a(3),d(" ",D(4,1,e.existingApplication.appliedAt,"short")," ")}}function ie(t,n){if(t&1&&(o(0,"div",17)(1,"strong"),r(2,"Reason:"),i(),r(3),i()),t&2){let e=p(2);a(3),d(" ",e.existingApplication.reason," ")}}function ne(t,n){if(t&1&&(o(0,"div",15)(1,"h5",16),r(2,"Application Status"),i(),o(3,"p",17),r(4,"You have already submitted an application."),i(),o(5,"div",18)(6,"strong"),r(7,"Status:"),i(),o(8,"span",19),r(9),i()(),g(10,te,5,4,"div",20)(11,ie,4,1,"div",20),m(12,"hr"),o(13,"p",6)(14,"strong"),r(15,"Name:"),i(),r(16),m(17,"br"),o(18,"strong"),r(19,"Bio:"),i(),r(20),i()()),t&2){let e=p();a(8),l("ngClass",w(6,ee,e.existingApplication.status==="pending",e.existingApplication.status==="approved",e.existingApplication.status==="rejected"||e.existingApplication.status==="revoked")),a(),d(" ",e.existingApplication.status==null?null:e.existingApplication.status.toUpperCase()," "),a(),l("ngIf",e.existingApplication.appliedAt),a(),l("ngIf",e.existingApplication.reason),a(5),d(" ",e.existingApplication.name),a(4),d(" ",e.existingApplication.bio||"No bio provided"," ")}}function oe(t,n){t&1&&(o(0,"div",21)(1,"h5",16),r(2,"Application Submitted!"),i(),o(3,"p"),r(4,"Your application has been submitted successfully. An admin will review it soon."),i()())}function re(t,n){if(t&1&&(o(0,"div",22),r(1),i()),t&2){let e=p();a(),d(" ",e.error," ")}}function ae(t,n){t&1&&m(0,"span",36)}function le(t,n){t&1&&m(0,"i",37)}function se(t,n){t&1&&(o(0,"div",38),m(1,"i",39),r(2," Please log in to submit an application. "),i())}function me(t,n){if(t&1){let e=I();o(0,"form",23),M("ngSubmit",function(){f(e);let c=p();return h(c.onSubmit())}),o(1,"div",24)(2,"label",25),r(3,"Author Name "),o(4,"span",26),r(5,"*"),i()(),o(6,"input",27),A("ngModelChange",function(c){f(e);let u=p();return _(u.formData.name,c)||(u.formData.name=c),h(c)}),i(),o(7,"div",28),r(8,"This will be your public author name (2-80 characters)"),i()(),o(9,"div",24)(10,"label",29),r(11,"Bio"),i(),o(12,"textarea",30),A("ngModelChange",function(c){f(e);let u=p();return _(u.formData.bio,c)||(u.formData.bio=c),h(c)}),i(),o(13,"div",28),r(14,"Optional. Maximum 2000 characters"),i()(),o(15,"div",31)(16,"button",32),g(17,ae,1,0,"span",33)(18,le,1,0,"i",34),r(19),i()(),g(20,se,3,0,"div",35),i()}if(t&2){let e=p();a(6),v("ngModel",e.formData.name),a(6),v("ngModel",e.formData.bio),a(4),l("disabled",e.loading||!e.authService.isAuthenticated()),a(),l("ngIf",e.loading),a(),l("ngIf",!e.loading),a(),d(" ",e.loading?"Submitting...":"Submit Application"," "),a(),l("ngIf",!e.authService.isAuthenticated())}}function ce(t,n){t&1&&(o(0,"div",40)(1,"a",41),m(2,"i",42),r(3," Go to Author Profile "),i()())}var b=class t{constructor(n,e){this.authorService=n;this.authService=e}formData={name:"",bio:""};loading=!1;error=null;success=!1;existingApplication=null;ngOnInit(){this.authService.isAuthenticated()&&this.checkExistingApplication()}checkExistingApplication(){this.authorService.getMyAuthorProfile().subscribe({next:n=>{this.existingApplication=n},error:n=>{n.error?.message!=="No author record found"&&console.error("Error checking application:",n)}})}onSubmit(){if(!this.authService.isAuthenticated()){this.error="Please log in to apply as an author";return}if(!this.formData.name||this.formData.name.trim().length<2){this.error="Name must be at least 2 characters";return}if(this.formData.name.length>80){this.error="Name must be less than 80 characters";return}if(this.formData.bio&&this.formData.bio.length>2e3){this.error="Bio must be less than 2000 characters";return}this.loading=!0,this.error=null,this.success=!1,this.authorService.applyAsAuthor(this.formData.name.trim(),this.formData.bio.trim()).subscribe({next:n=>{this.success=!0,this.loading=!1,this.existingApplication=n.author,this.formData={name:"",bio:""}},error:n=>{this.error=n.error?.message||"Failed to submit application",this.loading=!1,n.error?.author&&(this.existingApplication=n.error.author)}})}static \u0275fac=function(e){return new(e||t)(x(J),x(F))};static \u0275cmp=S({type:t,selectors:[["app-become-author"]],standalone:!1,decls:17,vars:7,consts:[[1,"become-author-container","py-5"],[1,"container"],[1,"row","justify-content-center"],[1,"col-12","col-md-8","col-lg-6"],[1,"card","shadow-sm"],[1,"card-header","bg-danger","text-white"],[1,"mb-0"],[1,"bi","bi-person-plus"],[1,"card-body","p-4"],["class","alert alert-info","role","alert",4,"ngIf"],["class","alert alert-success","role","alert",4,"ngIf"],["class","alert alert-danger","role","alert",4,"ngIf"],[3,"ngSubmit",4,"ngIf"],["class","mt-3",4,"ngIf"],[3,"categories"],["role","alert",1,"alert","alert-info"],[1,"alert-heading"],[1,"mb-2"],[1,"d-flex","align-items-center","gap-2","mb-2"],[1,"badge",3,"ngClass"],["class","mb-2",4,"ngIf"],["role","alert",1,"alert","alert-success"],["role","alert",1,"alert","alert-danger"],[3,"ngSubmit"],[1,"mb-3"],["for","name",1,"form-label"],[1,"text-danger"],["type","text","id","name","name","name","required","","minlength","2","maxlength","80","placeholder","Enter your author name",1,"form-control",3,"ngModelChange","ngModel"],[1,"form-text"],["for","bio",1,"form-label"],["id","bio","rows","5","name","bio","maxlength","2000","placeholder","Tell us about yourself as an author...",1,"form-control",3,"ngModelChange","ngModel"],[1,"d-grid"],["type","submit",1,"btn","btn-danger","btn-lg",3,"disabled"],["class","spinner-border spinner-border-sm me-2","role","status",4,"ngIf"],["class","bi bi-send",4,"ngIf"],["class","alert alert-warning mt-3","role","alert",4,"ngIf"],["role","status",1,"spinner-border","spinner-border-sm","me-2"],[1,"bi","bi-send"],["role","alert",1,"alert","alert-warning","mt-3"],[1,"bi","bi-exclamation-triangle"],[1,"mt-3"],["href","/author-profile",1,"btn","btn-outline-danger"],[1,"bi","bi-person-badge"]],template:function(e,s){e&1&&(m(0,"app-header"),o(1,"div",0)(2,"div",1)(3,"div",2)(4,"div",3)(5,"div",4)(6,"div",5)(7,"h2",6),m(8,"i",7),r(9," Become an Author"),i()(),o(10,"div",8),g(11,ne,21,10,"div",9)(12,oe,5,0,"div",10)(13,re,2,1,"div",11)(14,me,21,7,"form",12)(15,ce,4,0,"div",13),i()()()()()(),m(16,"app-footer",14)),e&2&&(a(11),l("ngIf",s.existingApplication),a(),l("ngIf",s.success),a(),l("ngIf",s.error),a(),l("ngIf",!s.existingApplication||s.existingApplication.status==="rejected"),a(),l("ngIf",s.existingApplication&&s.existingApplication.status==="approved"),a(),l("categories",E(6,$)))},dependencies:[N,P,q,j,k,W,G,Y,z,L,R,K,Q,T],styles:[".become-author-container[_ngcontent-%COMP%]{min-height:calc(100vh - 200px)}.card[_ngcontent-%COMP%]{border:none;border-radius:.5rem}.card-header[_ngcontent-%COMP%]{border-radius:.5rem .5rem 0 0!important}.form-label[_ngcontent-%COMP%]{font-weight:500;margin-bottom:.5rem}.form-control[_ngcontent-%COMP%]:focus{border-color:#dc3545;box-shadow:0 0 0 .2rem #dc354540}.btn-danger[_ngcontent-%COMP%]{background-color:#dc3545;border-color:#dc3545}.btn-danger[_ngcontent-%COMP%]:hover{background-color:#bb2d3b;border-color:#b02a37}.btn-danger[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.badge[_ngcontent-%COMP%]{font-size:.875rem;padding:.35em .65em}.alert[_ngcontent-%COMP%]{border-radius:.5rem}"]})};var pe=[{path:"",component:b}],X=class t{static \u0275fac=function(e){return new(e||t)};static \u0275mod=y({type:t});static \u0275inj=C({imports:[O,V.forChild(pe),H,U]})};export{X as BecomeAuthorModule};
