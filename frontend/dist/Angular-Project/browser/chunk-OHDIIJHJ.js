import{a as p}from"./chunk-VRDYXINS.js";import{B as u,E as n,Eb as d,Gb as o,Pb as h,g as c,j as i,z as s}from"./chunk-DBZ4JVQV.js";var m=class a{constructor(t,e){this.http=t;this.authService=e}apiUrl=h.apiUrl+"/cart";cartSubject=new c(null);cart$=this.cartSubject.asObservable();cartCountSubject=new c(0);cartCount$=this.cartCountSubject.asObservable();getHeaders(){return this.authService.getAuthHeaders()}getCart(){return this.http.get(this.apiUrl,{headers:this.getHeaders()}).pipe(s(t=>{t.success&&(this.cartSubject.next(t.data),this.updateCartCount(t.data))}))}addToCart(t){return this.http.post(this.apiUrl,t,{headers:this.getHeaders()}).pipe(s(e=>{e.success&&(this.cartSubject.next(e.data),this.updateCartCount(e.data))}))}updateCartItem(t){return this.http.put(this.apiUrl,t,{headers:this.getHeaders()}).pipe(s(e=>{e.success&&(this.cartSubject.next(e.data),this.updateCartCount(e.data))}))}removeFromCart(t){return this.http.delete(`${this.apiUrl}/${t}`,{headers:this.getHeaders()}).pipe(s(e=>{e.success&&(this.cartSubject.next(e.data),this.updateCartCount(e.data))}))}clearCart(){return this.http.delete(this.apiUrl,{headers:this.getHeaders()}).pipe(s(t=>{t.success&&(this.cartSubject.next(t.data),this.updateCartCount(t.data))}))}updateCartCount(t){let e=t.items.reduce((r,v)=>r+v.qty,0);this.cartCountSubject.next(e)}getCurrentCart(){return this.cartSubject.value}getCartTotal(){let t=this.cartSubject.value;return t?t.totals.subTotal:0}static \u0275fac=function(e){return new(e||a)(n(o),n(p))};static \u0275prov=u({token:a,factory:a.\u0275fac,providedIn:"root"})};var b=class a{constructor(t,e){this.http=t;this.authService=e}API_URL=h.apiUrl+"/authors";getAuthors(){return this.http.get(this.API_URL)}listAuthors(t={}){let e=new d;return t.status&&(e=e.set("status",t.status)),t.q&&(e=e.set("q",t.q)),t.page&&(e=e.set("page",t.page.toString())),t.limit&&(e=e.set("limit",t.limit.toString())),t.sort&&(e=e.set("sort",t.sort)),this.http.get(this.API_URL,{params:e})}getAuthorById(t){return this.http.get(`${this.API_URL}/${t}`)}getMyAuthorProfile(){let t=this.authService.getAuthHeaders();return this.authService.isAuthenticated()?this.http.get(`${this.API_URL}/me/profile`,{headers:t}):i(()=>({error:{message:"Not authenticated"}}))}applyAsAuthor(t,e){let r=this.authService.getAuthHeaders();return this.authService.isAuthenticated()?this.http.post(`${this.API_URL}/apply`,{name:t,bio:e},{headers:r}):i(()=>({error:{message:"Authentication required"}}))}approveAuthor(t,e){let r=this.authService.getAuthHeaders();return this.authService.isAuthenticated()?this.http.patch(`${this.API_URL}/${t}/approve`,e||{},{headers:r}):i(()=>({error:{message:"Authentication required"}}))}rejectAuthor(t,e){let r=this.authService.getAuthHeaders();return this.authService.isAuthenticated()?this.http.patch(`${this.API_URL}/${t}/reject`,{reason:e||""},{headers:r}):i(()=>({error:{message:"Authentication required"}}))}revokeAuthor(t,e){let r=this.authService.getAuthHeaders();return this.authService.isAuthenticated()?this.http.patch(`${this.API_URL}/${t}/revoke`,{reason:e||"Revoked by admin"},{headers:r}):i(()=>({error:{message:"Authentication required"}}))}static \u0275fac=function(e){return new(e||a)(n(o),n(p))};static \u0275prov=u({token:a,factory:a.\u0275fac,providedIn:"root"})};export{m as a,b};
