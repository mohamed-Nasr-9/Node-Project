import{a as s,r as c}from"./chunk-VRDYXINS.js";import{B as i,E as a,Lb as n}from"./chunk-DBZ4JVQV.js";var u=class o{constructor(e,t,r){this.authService=e;this.router=t;this.snackBar=r}canActivate(e,t){return this.authService.isAuthenticated()?this.checkAdminStatus()?!0:(this.snackBar.open("Access denied. Admin privileges required.","OK",{duration:3e3,horizontalPosition:"center",verticalPosition:"top"}),this.router.navigate(["/"]),!1):(this.snackBar.open("Please login to access the dashboard","Login",{duration:3e3,horizontalPosition:"center",verticalPosition:"top"}).onAction().subscribe(()=>{this.router.navigate(["/login"],{queryParams:{returnUrl:t.url}})}),this.router.navigate(["/login"],{queryParams:{returnUrl:t.url}}),!1)}checkAdminStatus(){let e=localStorage.getItem("user");if(e)try{return JSON.parse(e)?.role?.toLowerCase()==="admin"}catch{}let t=localStorage.getItem("authToken")||localStorage.getItem("auth_token");if(t)try{return JSON.parse(atob(t.split(".")[1]))?.role?.toLowerCase()==="admin"}catch{return!1}return!1}static \u0275fac=function(t){return new(t||o)(a(s),a(n),a(c))};static \u0275prov=i({token:o,factory:o.\u0275fac,providedIn:"root"})};export{u as a};
